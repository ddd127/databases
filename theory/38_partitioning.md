## 38. Секционирование


**Секционирование** - это разбиение таблицы на фрагменты
- фрагменты хранятся в разных местах
- возможно, на разных машинах (если пошардировали)
- секционирование уменьшает количество чтений с одного диска


**Вертикальное секционирование** - разрезание "по столбцам":
проекция - разрезать, соединение - восстановить

Преимущества:
- отделение "частых" данных от "редких" (столбцы нужны с разной частотой)
- меньше размер записи => больше записей на страницу
- защита информации
- автоматически поддержано для clob и blob

Недостатки:
- нет специальной поддержки, нужно делать руками
- заивисмость от представления
- необходимость обновляемых представлений


**Горизонтальное секционирование** - разрезание "по строкам":
фильтрация - разрезать, объединение - восстановить

Преимущества:
- отделение "близких" данных от "дальних" (например, по датам)
- уменьшение размера секции
- встроенная поддержка (в некоторых субд)
- прозрачность для пользователя, запросы не меняются

Недостатки:
- возможно замедление работы (если неудачно посекционировать)

**Методы горизонтального секционирования**

- Простые
    - По диапазонам
    - По значениям (при ограниченном числе значений)
    - По хешу (важно, чтобы распределение значений было хорошим)

- По выражению (оптимизатору может быть тяжеловато)

- Составные (секции разбиваются на подсекции)
    - возможно, по разным атрибутам
    - сначала по диапазону, потом по хешу


**Управление секциям**
- удаление секции
- разбиение секции
- перехеширование

Оптимизатор должен знать про секционирование,
понимать, где что находится
и уметь в операторы (=, in) обычно поддержаны хорошо,
(between, сравнения) - тут все сложнее


**Секционирование и индексы**
- локальный индекс на секцию / глобальный на таблицу
    
    Ускорение при отбрасывании секции

- секционированный индекс (разбит на секции не так, как таблица)

    Согласованное секционирование (напр. секция индекса = неск секци таблицы)


**Секционирование и ключи**

Очень хочется, чтобы секцию можно было определить по ключу, поэтому 
секционируемые столбцы - подключ всех ключей,
чтобы при обращении по ключу можно было определить конкретную секцию 
